<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style type="text/css">
    body {
        background-image: url("./backgroundTestImage.png");
        background-size: cover;
        background-repeat: no-repeat;
        background-color: #333;
        opacity: .3;
    }
    .col-1 {
        width: 8.33%;
    }

    .col-2 {
        width: 16.66%;
    }

    .col-3 {
        width: 25%;
    }

    .col-4 {
        width: 33.33%;
    }

    .col-5 {
        width: 41.66%;
    }

    .col-6 {
        width: 50%;
    }

    .col-7 {
        width: 58.33%;
    }

    .col-8 {
        width: 66.66%;
    }

    .col-9 {
        width: 75%;
    }

    .col-10 {
        width: 83.33%;
    }

    .col-11 {
        width: 91.66%;
    }

    .col-12 {
        width: 100%;
    }

    .row::after {
        content: "";
        clear: both;
        display: block;
    }

    [class*="col-"] {
        float: left;
    }

    li {
        text-align: center;
    }

    div#fixedHeader {
        position: static;
        width: 100%;
        height: auto;
    }

    div#titleContainer {
        text-align: center;
        display: inline;
        font-weight: bold;
    }

    a {
        text-decoration: none;
        font-family: 'Sans-Serif';
        font-color: rgb(106, 192, 203);
    }

    @media only screen and (max-width: 768px) {
        /* For mobile phones: */
        [class*="col-"] {
            width: 100%;
        }
        div#titleContainer {
            text-align: center;
        }

        body {
            /* background-image url updates to a small size png for mobile*/
            background-image: url("./backgroundTestImageMobile.png");
        }
    }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
</head>

<body>
    <div class="row">
        <div id="fixedHeader">
            <div class="col-12" id="titleContainer">
                    <form id="calc" action="index.html">
                        <input type="text" id="symbol" value=1 />
                        <input type="submit" value="No Cache">
                    </form>

            </div>
            <div class="col-12" id="titleContainer">

                    <form id="calcTwo" action="index.html">
                        <input type="text" id="symbolTwo" value=1 />
                        <input type="submit" value="Cache">
                    </form>
            </div>
        </div>
        <div class="col-12">
            <div class="row">
                <div class="col-6" id="tester" style="height:30%;"></div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript">
$(document).ready(function() {
    //check for existence of localstorage value, otherwise default to 1
    var previousEntry = localStorage.getItem('lastEntry') || 1;
    var previousEntryTwo = localStorage.getItem('lastEntryTwo') || 1;

    //assign localstorage value or default value to element
    $('#symbol').val(previousEntry)
    $('#symbolTwo').val(previousEntryTwo)

    $('#calc').on('submit', function(event) {
        event.preventDefault();
        var data = $('#symbol')

        //update local storage with new value
        localStorage.setItem('lastEntry', data[0].value)

        $.post("/api/noCache", {
            key: data[0].value
        }).done(function(response, errorHandler) {
            if (errorHandler !== 'success') {
                console.log('error 1');
                return;
            }
            if (response.error === true) {
                return
            } else {
                console.log(response)
                $('#tester').replaceWith('<div class="col-6" id="tester" style="height:30%;">'+response+'</div>');
            }
        });
    });

    $('#calcTwo').on('submit', function(event) {
        event.preventDefault();
        var data = $('#symbolTwo')

        //update local storage with new value
        localStorage.setItem('lastEntryTwo', data[0].value)

        $.post("/api/cache", {
            key: data[0].value
        }).done(function(response, errorHandler) {
            if (errorHandler !== 'success') {
                console.log('error 1');
                return;
            }
            if (response.error === true) {
                console.log('error 2');
                return
            } else {
                if (response.error) {
                    console.log('error 3');
                } else {
                    console.log(response)
                    $('#tester').replaceWith('<div class="col-6" id="tester" style="height:30%;">'+response+'</div>');
                }
            }
        });
    });
});
</script>

</html>
